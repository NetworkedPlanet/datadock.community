@model DataDock.Web.ViewModels.DashboardViewModel
@{
    Layout = "~/Views/Shared/_DashboardBaseLayout.cshtml";
    Model.Title = Model.Title + " Summary";
}

<div class="ui grid">
  <div class="eight wide column">
    <h3>Datasets</h3>
    <div id="loadingDatasets">
      @await Html.PartialAsync("_SpinnerPartial")
    </div>
    <div id="datasets"></div>

  </div>
  <div class="eight wide column">
    <h3>Jobs</h3>
    <div id="loadingJobs">
      @await Html.PartialAsync("_SpinnerPartial")
    </div>
    <div id="jobs"></div>
  </div>
</div>

@section Scripts { 
  <script type="text/javascript">
    $( document ).ready(function() {
      get_jobs();
      get_datasets();
    });

    function get_jobs() {
      var jobs = $.ajax({
        type: "GET",
        url: 'loader/jobs?ownerId=@Model.SelectedOwnerId&repoId=@Model.SelectedRepoId'
      }).done(function (data) {
        $('#jobs').html(data);
        $('#loadingJobs').hide();
        setTimeout(function () { get_jobs();}, 5000);
        }).responseText;
    }

    function get_datasets() {
      var datasets = $.ajax({
        type: "GET",
        url: 'loader/datasets?ownerId=@Model.SelectedOwnerId&repoId=@Model.SelectedRepoId'
      }).done(function (data) {
        $('#datasets').html(data);
        $('#loadingDatasets').hide();
        setTimeout(function () { get_datasets();}, 5000);
      }).responseText;
    }
  </script>
}